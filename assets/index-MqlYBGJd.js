import{A as x,D as j,d as w,c as U,e,K as t,r as m,o as ue,R as Me,F as L,E as r,y as I,z as A,I as pe,B as he,C as G,U as Ce,b as Ie,J as we,P as ke,n as De,l as Ee,Y as be,a0 as Le}from"./@vue-De5blAUZ.js";import{aO as Be}from"./@primeuix-2CofvoBZ.js";/* empty css                  *//* empty css                   */import{u as de,a as Ae,c as Fe,b as Oe}from"./vue-router-CpvcH4ea.js";import{d as ze,c as Ne}from"./pinia-lKNceXCq.js";import{a as je}from"./axios-Dq7h7Pqt.js";import{G as Te,W as qe}from"./@primevue-DPXn1zFT.js";import{u as ye,s as Ye,a as Xe,b as Ke,c as We,d as He,e as Ze,f as Ge,g as Je,h as Qe,i as et,j as tt,k as lt,l as st,m as at,n as ot,o as nt,p as it,q as rt,r as ut,T as dt,t as ct}from"./primevue-BVRgaH9a.js";import{G as mt,g as pt}from"./pdfjs-dist-GkTsfNbe.js";(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))d(y);new MutationObserver(y=>{for(const i of y)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function o(y){const i={};return y.integrity&&(i.integrity=y.integrity),y.referrerPolicy&&(i.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?i.credentials="include":y.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function d(y){if(y.ep)return;y.ep=!0;const i=o(y);fetch(y.href,i)}})();const fe=(c,g)=>{const o=c.__vccOpts||c;for(const[d,y]of g)o[d]=y;return o},vt={};function ft(c,g){const o=x("RouterView");return w(),j(o)}const gt=fe(vt,[["render",ft]]),ve=ze("user",{state:()=>({isAuthenticated:localStorage.getItem("isAuthenticated")||!1,user:localStorage.getItem("user")||null,token:localStorage.getItem("token")||!1}),actions:{login(c){this.isAuthenticated=!0,this.user=c.user,this.token=c.token},logout(){this.isAuthenticated=!1,this.user=null,this.token=null}}}),_t={class:"p-4"},bt={__name:"Home",setup(c){const g=de(),o=ve(),d=()=>{o.logout(),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("isAuthenticated"),g.push({name:"login"})};return(y,i)=>{const l=x("Button");return w(),U("div",_t,[i[0]||(i[0]=e("h1",{class:"text-xl mb-4"},"Welcome to Administrator Dashboard",-1)),t(l,{label:"Logout",icon:"pi pi-check",onClick:d})])}}},wt="http://159.65.8.237/api/api/",xe="http://159.65.8.237/api",K=je.create({baseURL:wt,timeout:3e4});K.interceptors.request.use(c=>{const g=ve();return g.token&&(c.headers.Authorization="Bearer "+g.token),c});const yt=c=>{if(!c.response)return console.error("**Network/Server error"),alert("Server is offline or unreachable"),Promise.reject(c);if(c.code==="ECONNABORTED")return console.error("Request timed out"),alert("Server took too long to respond."),Promise.reject(c);switch(c.response.status){case 400:console.error(c.response.status,c.message);break;case 401:ve().logout(),ne.push("/login");break;case 403:ne.push({name:"accessDenied"});break;default:console.error(c.response.status,c.message)}return Promise.reject(c)};K.interceptors.response.use(null,yt);const xt={login(c){return K.post("auth/login",c)}},ht={class:"surface-ground flex align-items-center justify-content-center min-h-screen min-w-screen overflow-hidden"},kt={class:"flex flex-column align-items-center justify-content-center"},$t={style:{"border-radius":"56px",padding:"0.3rem",background:"var(--primary-color)"}},At={class:"w-full surface-card py-8 px-5 sm:px-8",style:{"border-radius":"53px"}},St={__name:"Login",setup(c){const g=m(""),o=m(""),d=m({}),y=ve(),i=de();ue(()=>{y.isAuthenticated&&i.push({name:"home"})});const l=()=>{d.value={},g.value||(d.value.email="email is required"),o.value||(d.value.password="Password is required"),!d.value.email&&!d.value.password&&xt.login({email:g.value,password:o.value}).then(p=>{p.status===200&&(localStorage.setItem("token",p.data.token),localStorage.setItem("user",p.data.user),localStorage.setItem("isAuthenticated",!0),ve().login({user:p.data.user,token:p.data.token}),i.push({name:"home"}))}).catch(p=>{p&&(p.response.status===400||p.response.status===500)?d.value.general=p.response.data.message:d.value.general="An error occurred. Please try again later."})};return(p,D)=>{const v=x("InputText"),a=x("Message"),P=x("Password"),M=x("Button");return w(),U("div",ht,[e("div",kt,[e("div",$t,[e("div",At,[D[4]||(D[4]=e("div",{class:"text-center mb-5"},[e("div",{class:"text-900 text-3xl font-medium mb-3"},"Welcome back!"),e("span",{class:"text-600 font-medium"},"Sign in to continue")],-1)),e("form",{onKeyup:Me(l,["enter"])},[e("div",null,[D[2]||(D[2]=e("label",{for:"email",class:"block text-900 font-medium text-xl mb-2"},"Email",-1)),t(v,{id:"email",name:"email",type:"text",placeholder:"email",class:"w-full md:w-30rem",style:{padding:"1rem"},modelValue:g.value,"onUpdate:modelValue":D[0]||(D[0]=T=>g.value=T)},null,8,["modelValue"]),d.value.email?(w(),j(a,{key:0,severity:"error",size:"small",variant:"simple",class:"pt-1"},{default:r(()=>[I(A(d.value.email),1)]),_:1})):L("",!0),D[3]||(D[3]=e("label",{for:"password",class:"block text-900 font-medium text-xl mb-2 mt-4"},"Password",-1)),t(P,{id:"password",name:"password",modelValue:o.value,"onUpdate:modelValue":D[1]||(D[1]=T=>o.value=T),placeholder:"Password",toggleMask:!0,feedback:!1,class:"w-full",inputClass:"w-full",inputStyle:{padding:"1rem"}},null,8,["modelValue"]),d.value.password?(w(),j(a,{key:1,severity:"error",size:"small",variant:"simple",class:"pt-1"},{default:r(()=>[I(A(d.value.password),1)]),_:1})):L("",!0),d.value.general?(w(),j(a,{key:2,severity:"error",size:"small",variant:"simple",class:"pt-1"},{default:r(()=>[I(A(d.value.general),1)]),_:1})):L("",!0),t(M,{label:"Sign In",class:"w-full p-3 text-xl mt-5",onClick:l})])],32)])])])])}}},Ct=fe(St,[["__scopeId","data-v-97672f31"]]),Tt={class:"p-4"},Rt={__name:"NotFound",setup(c){return(g,o)=>(w(),U("div",Tt,o[0]||(o[0]=[e("h1",{class:"text-2xl font-bold"},"404 - Page Not Found",-1),e("p",{class:"mt-2"},"The page you are looking for does not exist.",-1)])))}},Pt={class:"flex flex-column gap-2"},Pe={__name:"SidebarMenu",setup(c){const g=de(),o=ve(),d=()=>{o.logout(),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("isAuthenticated"),g.push({name:"login"})};return(y,i)=>{const l=x("router-link"),p=x("Button");return w(),U(pe,null,[i[7]||(i[7]=e("h3",{class:"text-left m-0 mb-4"},"Assignment",-1)),e("div",Pt,[t(l,{to:"/",class:"p-button p-button-sm w-full text-left no-underline",onClick:i[0]||(i[0]=D=>y.$emit("navigate"))},{default:r(()=>i[3]||(i[3]=[I("Home")])),_:1,__:[3]}),t(l,{to:"/exam-templates",class:"p-button p-button-sm w-full text-left no-underline",onClick:i[1]||(i[1]=D=>y.$emit("navigate"))},{default:r(()=>i[4]||(i[4]=[I("Exam Templates")])),_:1,__:[4]}),t(l,{to:"/users",class:"p-button p-button-sm w-full text-left no-underline",onClick:i[2]||(i[2]=D=>y.$emit("navigate"))},{default:r(()=>i[5]||(i[5]=[I("Users")])),_:1,__:[5]}),t(p,{class:"p-button p-button-sm w-full text-left",onClick:d},{default:r(()=>i[6]||(i[6]=[I("Logout")])),_:1,__:[6]})])],64)}}},It={class:"flex h-screen"},Vt={class:"hidden md:flex flex-column bg-gray-100 p-4 w-16rem shrink-0 sticky top-0 overflow-y-auto shadow"},Ut={class:"flex md:hidden items-center justify-between bg-gray-200 p-3 fixed top-0 left-0 right-0 z-50"},Mt={key:0,class:"fixed top-0 left-0 h-full w-16rem bg-gray-200 shadow-2 z-50 p-4 transition-transform",style:{transform:"translateX(0)","z-index":"50"}},Dt={class:"flex justify-end mb-3"},Et={class:"flex-1 overflow-auto p-4 w-full mt-5 md:mt-0"},Lt={__name:"AppLayout",setup(c){const g=m(!1);return(o,d)=>{const y=x("Toast"),i=x("Button"),l=x("RouterView");return w(),U(pe,null,[t(y),e("div",It,[e("div",Vt,[t(Pe)]),e("div",Ut,[t(i,{icon:"pi pi-bars",text:"",onClick:d[0]||(d[0]=p=>g.value=!0)}),d[3]||(d[3]=e("div",{class:"font-bold",style:{"line-height":"40px"}},"My App",-1))]),g.value?(w(),U("div",Mt,[e("div",Dt,[t(i,{icon:"pi pi-times",text:"",onClick:d[1]||(d[1]=p=>g.value=!1)})]),t(Pe,{onNavigate:d[2]||(d[2]=p=>g.value=!1)})])):L("",!0),e("div",Et,[t(l)])])],64)}}},$e={addUser(c){return K.post("users",c)},getUsers(){return K.get("users")},getUser(c){return K.get("users/"+c)},updateUser(c,g){return K.put("users/"+c,g)},softDeleteUsers(c){return K.put("users/delete-many",c)},restoreUsers(c){return K.put("users/restore",c)},deleteUsers(c){return K.delete("users/delete",{data:c})}},Bt={class:"grid"},Ft={class:"col-12"},Ot={class:"card main-card"},zt={class:"my-2"},Nt={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},jt={class:"flex items-center gap-4 mb-4"},qt={class:"flex flex-column flex-auto gap-1"},Yt={class:"flex items-center gap-4 mb-4"},Xt={class:"flex flex-column flex-auto gap-1"},Kt={class:"flex items-center gap-4 mb-4"},Wt={class:"flex flex-column flex-auto gap-1"},Ht={class:"flex items-center gap-4 mb-4"},Zt={class:"flex flex-column flex-auto gap-1"},Gt={class:"flex flex-wrap gap-4"},Jt={class:"flex items-center gap-2"},Qt={class:"flex items-center gap-2"},el={class:"flex items-center gap-2"},tl={class:"flex items-center gap-4 mb-4"},ll={class:"flex flex-column flex-auto gap-1"},sl={class:"flex flex-wrap gap-4"},al={class:"flex items-center gap-2"},ol={class:"flex items-center gap-2"},nl={class:"field"},il={key:0,class:"p-error"},rl={class:"flex align-items-center justify-content-center my-3"},ul={key:0},dl={__name:"Users",setup(c){const g=ye(),o=m({}),d=m(null),y=m(!1),i=m(!1),l=m({}),p=m(null),D=m(null),v=m(!1),a=m({global:{value:null,matchMode:Te.CONTAINS}});ue(()=>{$e.getUsers().then(k=>{k.status===200&&(d.value=k.data)}).catch(k=>{k&&(k.response.status===400||k.response.status===500)?o.value.general=k.response.data.message:o.value.general="An error occurred. Please try again later."})});const P=()=>{l.value={role:"administrator",status:"active"},v.value=!1,y.value=!0},M=k=>{l.value={...k},v.value=!1,y.value=!0},T=()=>{y.value=!1,v.value=!1},S=k=>{let s=-1;for(let b=0;b<d.value.length;b++)if(d.value[b]._id===k){s=b;break}return s},R=()=>{o.value={};let k=!0;return l.value.name||(o.value.name="Name is required",k=!1),l.value.email||(o.value.email="email is required",k=!1),!l.value._id&&!l.value.password&&(o.value.password="Password is required",k=!1),l.value.email!=null&&l.value.email!=""&&(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(l.value.email)||(o.value.email="Invalid Email Address",k=!1)),k},h=()=>{if(v.value=!0,R())if(l.value._id){const k={name:l.value.name,email:l.value.email,password:l.value.password,role:l.value.role,status:l.value.status};$e.updateUser(l.value._id,k).then(s=>{if(console.log(s),s.status===200){delete l.value.password;const b=s.data;l.value.createdAt=b.data.createdAt,l.value.updatedAt=b.data.updatedAt,d.value[S(l.value._id)]=l.value,g.add({severity:"success",summary:"Successful",detail:s.data.message,life:3e3}),y.value=!1,l.value={}}}).catch(s=>{if(s&&s.response.status===400){if(console.log(s),s.response.data.errors&&s.response.data.errors.length>0)for(const b of s.response.data.errors)b.key=="name"?o.value.name=b.message:b.key=="email"?o.value.email=b.message:b.key=="password"?o.value.password=b.message:o.value.general=b.message}else o.value.general="An error occurred. Please try again later."})}else $e.addUser(l.value).then(k=>{if(k.status===201){delete l.value.password;const s=k.data;l.value._id=s.data._id,l.value.createdAt=s.data.createdAt,l.value.updatedAt=s.data.updatedAt,d.value.push(l.value),g.add({severity:"success",summary:"Successful",detail:k.data.message,life:3e3}),y.value=!1,l.value={}}}).catch(k=>{if(k&&k.response.status===400){if(console.log(k),k.response.data.errors&&k.response.data.errors.length>0)for(const s of k.response.data.errors)s.key=="name"?o.value.name=s.message:s.key=="email"?o.value.email=s.message:s.key=="password"?o.value.password=s.message:o.value.general=s.message}else o.value.general="An error occurred. Please try again later."})},f=()=>{D.value.exportCSV()},Z=()=>{i.value=!0},X=()=>{if(o.value={},p.value.length>0){const k={ids:p.value.map(s=>s._id)};$e.softDeleteUsers(k).then(s=>{s.status===200&&(d.value=d.value.filter(b=>!p.value.includes(b)),i.value=!1,p.value=null,g.add({severity:"success",summary:"Successful",detail:s.data.message,life:3e3}))}).catch(s=>{s&&(s.response.status===400||s.response.status===404||s.response.status===500)?o.value.general=s.response.data.message:o.value.general="An error occurred. Please try again later.",i.value=!1,p.value=null,g.add({severity:"error",summary:"Error",detail:o.value.general,life:3e3})})}else i.value=!1,p.value=null};return(k,s)=>{const b=x("Button"),C=x("Toolbar"),E=x("InputIcon"),J=x("InputText"),ee=x("IconField"),q=x("Column"),le=x("DataTable"),W=x("Message"),se=x("Password"),Q=x("RadioButton"),te=x("Dialog"),N=he("tooltip");return w(),U("div",Bt,[e("div",Ft,[e("div",Ot,[t(C,{class:"mb-4"},{start:r(()=>[e("div",zt,[t(b,{label:"New",icon:"pi pi-plus",class:"mr-2",severity:"success",onClick:P}),t(b,{label:"Delete",icon:"pi pi-trash",severity:"danger",onClick:Z,disabled:!p.value||!p.value.length},null,8,["disabled"])])]),end:r(()=>[t(b,{label:"Export",icon:"pi pi-upload",severity:"help",onClick:s[0]||(s[0]=_=>f(_))})]),_:1}),t(le,{ref_key:"dt",ref:D,stripedRows:"",value:d.value,selection:p.value,"onUpdate:selection":s[2]||(s[2]=_=>p.value=_),dataKey:"_id",paginator:!0,rows:100,filters:a.value,"onUpdate:filters":s[3]||(s[3]=_=>a.value=_),filterDisplay:"row",globalFilterFields:["name","email","role","status"],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[100,200,300],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} users"},{header:r(()=>[e("div",Nt,[s[15]||(s[15]=e("h5",{class:"m-0"},"Manage Users",-1)),t(ee,{iconPosition:"left",class:"block mt-2 md:mt-0"},{default:r(()=>[t(E,{class:"pi pi-search"}),t(J,{class:"w-full sm:w-auto",modelValue:a.value.global.value,"onUpdate:modelValue":s[1]||(s[1]=_=>a.value.global.value=_),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:r(()=>[t(q,{selectionMode:"multiple",headerStyle:"width: 3rem"}),t(q,{field:"name",header:"name",sortable:!0,headerStyle:""},{body:r(_=>[I(A(_.data.name),1)]),_:1}),t(q,{field:"email",header:"Email",sortable:!0,headerStyle:""},{body:r(_=>[I(A(_.data.email),1)]),_:1}),t(q,{field:"role",header:"Role",sortable:!0,headerStyle:""},{body:r(_=>[I(A(_.data.role),1)]),_:1}),t(q,{field:"role",header:"Status",sortable:!0,headerStyle:""},{body:r(_=>[I(A(_.data.status),1)]),_:1}),G(t(q,{headerStyle:"width: 3rem"},{body:r(_=>[G(t(b,{icon:"pi pi-pencil",class:"mr-2",severity:"success",rounded:"",onClick:ae=>M(_.data)},null,8,["onClick"]),[[N,"Edit User",void 0,{bottom:!0}]])]),_:1},512),[[Ce,!1]]),t(q,{field:"createdAt",hidden:!0}),t(q,{field:"updatedAt",hidden:!0})]),_:1},8,["value","selection","filters"]),t(te,{visible:y.value,"onUpdate:visible":s[12]||(s[12]=_=>y.value=_),style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},header:l.value._id?"Update User":"Add New User",modal:!0,class:""},{footer:r(()=>[t(b,{label:"Cancel",icon:"pi pi-times",onClick:T,severity:"secondary"}),t(b,{label:l.value._id?"Update":"Save",icon:"pi pi-check",onClick:h},null,8,["label"])]),default:r(()=>[e("div",jt,[s[16]||(s[16]=e("label",{for:"name",class:"font-medium mt-2",style:{width:"75px"}},"Name",-1)),e("div",qt,[t(J,{modelValue:l.value.name,"onUpdate:modelValue":s[4]||(s[4]=_=>l.value.name=_),modelModifiers:{trim:!0},invalid:v.value&&"name"in o.value,placeholder:"Name",id:"name",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),v.value&&o.value.name?(w(),j(W,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(o.value.name),1)]),_:1})):L("",!0)])]),e("div",Yt,[s[17]||(s[17]=e("label",{for:"email",class:"font-medium mt-2",style:{width:"75px"}},"Email",-1)),e("div",Xt,[t(J,{modelValue:l.value.email,"onUpdate:modelValue":s[5]||(s[5]=_=>l.value.email=_),modelModifiers:{trim:!0},invalid:v.value&&"email"in o.value,placeholder:"Email",id:"email",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),v.value&&o.value.email?(w(),j(W,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(o.value.email),1)]),_:1})):L("",!0)])]),e("div",Kt,[s[18]||(s[18]=e("label",{for:"password",class:"font-medium mt-2",style:{width:"75px"}},"Password",-1)),e("div",Wt,[t(se,{modelValue:l.value.password,"onUpdate:modelValue":s[6]||(s[6]=_=>l.value.password=_),modelModifiers:{trim:!0},invalid:v.value&&"password"in o.value,placeholder:"Password",id:"password",class:"w-full",autocomplete:"off",feedback:!1},null,8,["modelValue","invalid"]),v.value&&o.value.password?(w(),j(W,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(o.value.password),1)]),_:1})):L("",!0)])]),e("div",Ht,[s[22]||(s[22]=e("label",{for:"role",class:"font-medium",style:{width:"75px"}},"Role",-1)),e("div",Zt,[e("div",Gt,[e("div",Jt,[t(Q,{modelValue:l.value.role,"onUpdate:modelValue":s[7]||(s[7]=_=>l.value.role=_),inputId:"student",name:"role",value:"student"},null,8,["modelValue"]),s[19]||(s[19]=e("label",{for:"student"},"Student",-1))]),e("div",Qt,[t(Q,{modelValue:l.value.role,"onUpdate:modelValue":s[8]||(s[8]=_=>l.value.role=_),inputId:"teacher",name:"role",value:"teacher"},null,8,["modelValue"]),s[20]||(s[20]=e("label",{for:"teacher"},"Teacher",-1))]),e("div",el,[t(Q,{modelValue:l.value.role,"onUpdate:modelValue":s[9]||(s[9]=_=>l.value.role=_),inputId:"administrator",name:"role",value:"administrator"},null,8,["modelValue"]),s[21]||(s[21]=e("label",{for:"administrator"},"Administrator",-1))])]),v.value&&o.value.role?(w(),j(W,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(o.value.role),1)]),_:1})):L("",!0)])]),e("div",tl,[s[25]||(s[25]=e("label",{for:"role",class:"font-medium",style:{width:"75px"}},"Status",-1)),e("div",ll,[e("div",sl,[e("div",al,[t(Q,{modelValue:l.value.status,"onUpdate:modelValue":s[10]||(s[10]=_=>l.value.status=_),inputId:"active",name:"status",value:"active"},null,8,["modelValue"]),s[23]||(s[23]=e("label",{for:"active"},"Active",-1))]),e("div",ol,[t(Q,{modelValue:l.value.status,"onUpdate:modelValue":s[11]||(s[11]=_=>l.value.status=_),inputId:"inactive",name:"status",value:"inactive"},null,8,["modelValue"]),s[24]||(s[24]=e("label",{for:"inactive"},"Inactive",-1))])]),v.value&&o.value.role?(w(),j(W,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(o.value.role),1)]),_:1})):L("",!0)])]),e("div",nl,[v.value&&o.value.general?(w(),U("small",il,A(o.value.general),1)):L("",!0)])]),_:1},8,["visible","header"]),t(te,{visible:i.value,"onUpdate:visible":s[14]||(s[14]=_=>i.value=_),style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},header:"Confirmation",modal:!0},{footer:r(()=>[t(b,{label:"No",icon:"pi pi-times",onClick:s[13]||(s[13]=_=>i.value=!1),severity:"secondary"}),t(b,{label:"Yes",icon:"pi pi-check",onClick:X,severity:"danger"})]),default:r(()=>[e("div",rl,[s[26]||(s[26]=e("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),l.value?(w(),U("span",ul,"Are you sure you want to delete the selected users?")):L("",!0)])]),_:1},8,["visible"])])])])}}},cl=fe(dl,[["__scopeId","data-v-c9c1cdf2"]]),ml={class:"flex flex-column h-screen"},pl={class:"my-2"},vl={class:"flex-grow-1 overflow-y-auto p-4",style:{"max-width":"100%","white-space":"nowrap"}},fl=["onMousedown"],gl=["onMousedown"],_l={class:"text-xs text-red-700"},bl={class:"flex items-center gap-4 mb-4"},wl={class:"font-medium"},yl={class:"flex items-center gap-4 mb-4"},xl={class:"font-medium"},hl={class:"flex items-center gap-4 mb-4"},kl={class:"flex flex-column flex-auto gap-1"},$l={class:"flex items-center gap-4 mb-4"},Al={class:"flex flex-column flex-auto gap-1"},Sl={class:"flex flex-wrap gap-4"},Cl={class:"flex items-center gap-2"},Tl={class:"flex items-center gap-2"},Rl={class:"flex items-center gap-2"},Pl={class:"flex items-center gap-2"},Il={class:"flex items-center gap-4 mb-4"},Vl={class:"flex flex-column flex-auto gap-1"},Ul={class:"flex items-center gap-4 mb-4"},Ml={class:"flex flex-column flex-auto gap-1"},Dl={class:"flex items-center gap-4 mb-4"},El={class:"flex flex-column flex-auto gap-1"},Ll={class:"flex items-center gap-4 mb-4"},Bl={class:"flex flex-column flex-auto gap-1"},Fl={class:"field"},Ol={key:0,class:"p-error"},zl={__name:"PdfRegionMarker",props:{documentPath:String,regionsFromServer:Object},emits:["saveRegion"],setup(c,{emit:g}){mt.workerSrc="/pdf.worker.min.mjs";const o=c,d=g;function y(){d("saveRegion",v)}const i=de(),l=m(1),p=m([]),D=[],v=m(o.regionsFromServer),a=m(null),P=m(!1),M=m(!1),T=m(null),S=Ie({x:0,y:0}),R=m(!1),h=m(!1),f=m({}),Z=m(o.documentPath),X=async()=>{const B=await pt(Z.value).promise,u=B.numPages;p.value=Array.from({length:u});for(let $=1;$<=u;$++){const n=await B.getPage($),V=n.getViewport({scale:l.value}),O=D[$-1],F=O.getContext("2d");O.width=V.width,O.height=V.height,await n.render({canvasContext:F,viewport:V}).promise}},k=()=>{l.value+=.2,X()},s=()=>{l.value=1,X()},b=()=>{l.value>.4&&(l.value-=.2,X())},C=(B,u)=>{const n=D[u].getBoundingClientRect(),V=(B.clientX-n.left)/l.value,O=(B.clientY-n.top)/l.value;S.x=V,S.y=O,T.value=u,a.value=null,P.value=!0,v.value[u]||(v.value[u]=[]);const F={x:V,y:O,width:0,height:0,_temp:!0,pageIndex:u,label:`R${(v.value[u].filter(H=>!H._temp).length||0)+1}`};v.value[u]=v.value[u].filter(H=>!H._temp),v.value[u].push(F)},E=B=>{if(!P.value||T.value===null)return;const $=D[T.value].getBoundingClientRect(),n=(B.clientX-$.left)/l.value,V=(B.clientY-$.top)/l.value,O=v.value[T.value].find(F=>F._temp);O&&(O.width=n-S.x,O.height=V-S.y)},J=()=>{if(!P.value||T.value===null)return;P.value=!1;const B=T.value,u=v.value[B]?.find($=>$._temp);u&&(u.width<0&&(u.x+=Math.abs(u.width),u.width=Math.abs(u.width)),u.height<0&&(u.y+=Math.abs(u.height),u.height=Math.abs(u.height)),Math.abs(u.width)>5&&Math.abs(u.height)>5?delete u._temp:v.value[B]=v.value[B].filter($=>!$._temp),T.value=null)},ee=(B,u)=>{M.value=!0,a.value=u,S.x=B.offsetX,S.y=B.offsetY,B.stopPropagation()},q=B=>{if(!M.value||!a.value)return;const u=B.movementX/l.value,$=B.movementY/l.value;a.value.x+=u,a.value.y+=$},le=()=>{M.value=!1},W=()=>{if(!a.value)return;const B=a.value.pageIndex,u=v.value[B].indexOf(a.value);u!==-1&&(v.value[B].splice(u,1),a.value=null)},se=()=>{a.value=null,v.value={}},Q=()=>{if(h.value=!0,!!a.value){if(a.value.label=a.value.label,!a.value.label){f.value.label="Label is required";return}v.value={...v.value},R.value=!1}},te=B=>{const u=B.x*l.value,$=B.y*l.value,n=B.width*l.value,V=B.height*l.value;return{position:"absolute",left:`${u}px`,top:`${$}px`,width:`${n}px`,height:`${V}px`,border:B===a.value?"2px solid blue":"2px solid red",backgroundColor:"rgba(255, 0, 0, 0.2)",cursor:"move"}},N=()=>{h.value=!1,R.value=!0},_=()=>{a.value=null,h.value=!1,R.value=!1},ae=()=>{i.push({name:"examTemplates"})};return ue(()=>{X(),window.addEventListener("mouseup",()=>{J(),le()}),window.addEventListener("mousemove",q)}),(B,u)=>{const $=x("Button"),n=x("Toolbar"),V=x("InputText"),O=x("Message"),F=x("RadioButton"),H=x("InputNumber"),oe=x("Dialog"),ie=he("tooltip");return w(),U("div",ml,[t(n,{class:"sticky top-0 z-5 p-3 surface-0 border-bottom-1 surface-border pb-2"},{start:r(()=>[e("div",pl,[t($,{type:"button",label:"Back",icon:"pi pi-arrow-left",onClick:ae,class:"mr-2"}),t($,{label:"Update Selected",icon:"pi pi-pencil",onClick:N,disabled:!a.value,class:"mr-2",size:""},null,8,["disabled"]),t($,{label:"Delete Selected",icon:"pi pi-trash",onClick:W,class:"p-button-danger mr-2",size:""}),t($,{label:"Delete All",icon:"pi pi-trash",onClick:se,class:"p-button-danger mr-2",disabled:v.value.length<1,size:""},null,8,["disabled"]),t($,{label:"Save",icon:"pi pi-save",onClick:y,class:"p-button-success"})])]),end:r(()=>[G(t($,{icon:"pi pi-search-plus",onClick:k,class:"mr-2",rounded:""},null,512),[[ie,"Zoom In",void 0,{bottom:!0}]]),G(t($,{icon:"pi pi-search-minus",onClick:b,class:"mr-2",rounded:""},null,512),[[ie,"Zoom Out",void 0,{bottom:!0}]]),G(t($,{icon:"pi pi-refresh",onClick:s,class:"mr-2",rounded:""},null,512),[[ie,"Zoom Reset",void 0,{bottom:!0}]])]),_:1}),e("div",vl,[u[10]||(u[10]=e("h4",{class:""},"Create Answer Region",-1)),u[11]||(u[11]=e("p",{class:"text-xs mb-5"},[I(" 1. Click and drag your mouse to draw a rectangle around the area to assign an answer region. "),e("br"),I(" 2. After drawing, click inside the rectangle to select update the info or adjust its position by dragging."),e("br"),I(' 3. Click "Save" button, after all region are assign. ')],-1)),(w(!0),U(pe,null,we(p.value,(Y,ce)=>(w(),U("div",{key:ce,class:"relative mb-6 bg-white p-0 rounded-md shadow"},[e("canvas",{ref_for:!0,ref:z=>D[ce]=z,onMousedown:z=>C(z,ce),onMousemove:E,style:{border:"1px solid #ccc"}},null,40,fl),(w(!0),U(pe,null,we(v.value[ce]||[],(z,_e)=>(w(),U("div",{key:_e,style:ke(te(z)),class:"absolute",onMousedown:re=>ee(re,z),onMouseup:le},[e("small",_l,A(z.label),1)],44,gl))),128))]))),128))]),t(oe,{visible:R.value,"onUpdate:visible":u[9]||(u[9]=Y=>R.value=Y),style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},header:"Update Info",modal:!0,class:""},{footer:r(()=>[t($,{label:"Cancel",icon:"pi pi-times",onClick:_,severity:"secondary"}),t($,{label:"Save",icon:"pi pi-check",onClick:Q})]),default:r(()=>[e("div",bl,[u[12]||(u[12]=e("label",{for:"label",class:"font-medium",style:{width:"75px"}},"Page No",-1)),e("div",wl,A(a.value.pageIndex+1),1)]),e("div",yl,[u[13]||(u[13]=e("label",{for:"label",class:"font-medium",style:{width:"75px"}},"Coordinate",-1)),e("div",xl," ["+A(a.value.x)+", "+A(a.value.y)+", "+A(a.value.width)+", "+A(a.value.height)+"] ",1)]),e("div",hl,[u[14]||(u[14]=e("label",{for:"label",class:"font-medium mt-2",style:{width:"75px"}},"Label",-1)),e("div",kl,[t(V,{modelValue:a.value.label,"onUpdate:modelValue":u[0]||(u[0]=Y=>a.value.label=Y),modelModifiers:{trim:!0},invalid:h.value&&"label"in f.value,placeholder:"label",id:"label",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.label?(w(),j(O,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.label),1)]),_:1})):L("",!0)])]),e("div",$l,[u[19]||(u[19]=e("label",{for:"role",class:"font-medium",style:{width:"75px"}},"Type",-1)),e("div",Al,[e("div",Sl,[e("div",Cl,[t(F,{modelValue:a.value.type,"onUpdate:modelValue":u[1]||(u[1]=Y=>a.value.type=Y),inputId:"multiple_choice",name:"regionType",value:"multiple_choice"},null,8,["modelValue"]),u[15]||(u[15]=e("label",{for:"multiple_choice"},"multiple choice",-1))]),e("div",Tl,[t(F,{modelValue:a.value.type,"onUpdate:modelValue":u[2]||(u[2]=Y=>a.value.type=Y),inputId:"short_answer",name:"regionType",value:"short_answer"},null,8,["modelValue"]),u[16]||(u[16]=e("label",{for:"short_answer"},"short answer",-1))]),e("div",Rl,[t(F,{modelValue:a.value.type,"onUpdate:modelValue":u[3]||(u[3]=Y=>a.value.type=Y),inputId:"long_answer",name:"regionType",value:"long_answer"},null,8,["modelValue"]),u[17]||(u[17]=e("label",{for:"long_answer"},"long answer",-1))]),e("div",Pl,[t(F,{modelValue:a.value.type,"onUpdate:modelValue":u[4]||(u[4]=Y=>a.value.type=Y),inputId:"qr_code",name:"regionType",value:"qr code"},null,8,["modelValue"]),u[18]||(u[18]=e("label",{for:"qr_code"},"qr code",-1))])]),h.value&&f.value.type?(w(),j(O,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.type),1)]),_:1})):L("",!0)])]),e("div",Il,[u[20]||(u[20]=e("label",{for:"options",class:"font-medium mt-2",style:{width:"75px"}},"Options",-1)),e("div",Vl,[t(V,{modelValue:a.value.options,"onUpdate:modelValue":u[5]||(u[5]=Y=>a.value.options=Y),modelModifiers:{trim:!0},invalid:h.value&&"options"in f.value,placeholder:"options",id:"options",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.options?(w(),j(O,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.options),1)]),_:1})):L("",!0)])]),e("div",Ul,[u[21]||(u[21]=e("label",{for:"correctAnswer",class:"font-medium mt-2",style:{width:"75px"}},"Correct Answer",-1)),e("div",Ml,[t(V,{modelValue:a.value.correctAnswer,"onUpdate:modelValue":u[6]||(u[6]=Y=>a.value.correctAnswer=Y),modelModifiers:{trim:!0},invalid:h.value&&"correctAnswer"in f.value,placeholder:"correctAnswer",id:"correctAnswer",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.correctAnswer?(w(),j(O,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.correctAnswer),1)]),_:1})):L("",!0)])]),e("div",Dl,[u[22]||(u[22]=e("label",{for:"rubricAnswer",class:"font-medium mt-2",style:{width:"75px"}},"Rubric Answer",-1)),e("div",El,[t(V,{modelValue:a.value.rubricAnswer,"onUpdate:modelValue":u[7]||(u[7]=Y=>a.value.rubricAnswer=Y),modelModifiers:{trim:!0},invalid:h.value&&"rubricAnswer"in f.value,placeholder:"correctAnswer",id:"rubricAnswer",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.rubricAnswer?(w(),j(O,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.rubricAnswer),1)]),_:1})):L("",!0)])]),e("div",Ll,[u[23]||(u[23]=e("label",{for:"points",class:"font-medium mt-2",style:{width:"75px"}},"Points",-1)),e("div",Bl,[t(H,{modelValue:a.value.points,"onUpdate:modelValue":u[8]||(u[8]=Y=>a.value.points=Y),modelModifiers:{trim:!0},invalid:h.value&&"points"in f.value,placeholder:"points",id:"points",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.points?(w(),j(O,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.points),1)]),_:1})):L("",!0)])]),e("div",Fl,[h.value&&f.value.general?(w(),U("small",Ol,A(f.value.general),1)):L("",!0)])]),_:1},8,["visible"])])}}},Nl={class:"flex flex-column h-screen"},jl={class:"my-2"},ql={class:"flex-grow-1 overflow-y-auto p-4",style:{"max-width":"100%","white-space":"nowrap"}},Yl=["onMousedown"],Xl=["onMousedown"],Kl={class:"text-xs text-red-700"},Wl={class:"flex items-center gap-4 mb-4"},Hl={class:"font-medium"},Zl={class:"flex items-center gap-4 mb-4"},Gl={class:"font-medium"},Jl={class:"flex items-center gap-4 mb-4"},Ql={class:"flex flex-column flex-auto gap-1"},es={class:"flex items-center gap-4 mb-4"},ts={class:"flex flex-column flex-auto gap-1"},ls={class:"flex flex-wrap gap-4"},ss={class:"flex items-center gap-2"},as={class:"flex items-center gap-2"},os={class:"flex items-center gap-2"},ns={class:"flex items-center gap-2"},is={class:"flex items-center gap-4 mb-4"},rs={class:"flex flex-column flex-auto gap-1"},us={class:"flex items-center gap-4 mb-4"},ds={class:"flex flex-column flex-auto gap-1"},cs={class:"flex items-center gap-4 mb-4"},ms={class:"flex flex-column flex-auto gap-1"},ps={class:"flex items-center gap-4 mb-4"},vs={class:"flex flex-column flex-auto gap-1"},fs={class:"field"},gs={key:0,class:"p-error"},_s={__name:"ImageRegionMarker",props:{documentPath:String,regionsFromServer:Object},emits:["saveRegion"],setup(c,{emit:g}){const o=c,d=g;function y(){d("saveRegion",v)}const i=de(),l=m(1),p=m([]),D=[],v=m(o.regionsFromServer),a=m(null),P=m(!1),M=m(!1),T=m(null),S=Ie({x:0,y:0}),R=m(!1),h=m(!1),f=m({}),X=[m(o.documentPath).value];p.value=X;const k=async()=>{for(let $=0;$<X.length;$++)await s(X[$],$)},s=async($,n)=>{await De();const V=D[n];if(!V){console.warn(`Canvas at index ${n} is not ready yet.`);return}const O=V.getContext("2d"),F=new Image;F.onload=()=>{V.width=F.width*l.value,V.height=F.height*l.value,O.drawImage(F,0,0,V.width,V.height)},F.onerror=()=>{console.error(`Failed to load image: ${$}`)},F.src=$},b=async()=>{l.value+=.2,await k()},C=async()=>{l.value=1,await k()},E=async()=>{l.value>.4&&(l.value-=.2,await k())},J=($,n)=>{const O=D[n].getBoundingClientRect(),F=($.clientX-O.left)/l.value,H=($.clientY-O.top)/l.value;S.x=F,S.y=H,T.value=n,a.value=null,P.value=!0,v.value[n]||(v.value[n]=[]);const oe={x:F,y:H,width:0,height:0,_temp:!0,pageIndex:n,label:`R${(v.value[n].filter(ie=>!ie._temp).length||0)+1}`};v.value[n]=v.value[n].filter(ie=>!ie._temp),v.value[n].push(oe)},ee=$=>{if(!P.value||T.value===null)return;const V=D[T.value].getBoundingClientRect(),O=($.clientX-V.left)/l.value,F=($.clientY-V.top)/l.value,H=v.value[T.value].find(oe=>oe._temp);H&&(H.width=O-S.x,H.height=F-S.y)},q=()=>{if(!P.value||T.value===null)return;P.value=!1;const $=T.value,n=v.value[$]?.find(V=>V._temp);n&&(n.width<0&&(n.x=Math.abs(n.x+n.width),n.width=Math.abs(n.width)),n.height<0&&(n.y=Math.abs(n.y+n.height),n.height=Math.abs(n.height)),Math.abs(n.width)>5&&Math.abs(n.height)>5?delete n._temp:v.value[$]=v.value[$].filter(V=>!V._temp),T.value=null)},le=($,n)=>{M.value=!0,a.value=n,S.x=$.offsetX,S.y=$.offsetY,$.stopPropagation()},W=$=>{if(!M.value||!a.value)return;const n=$.movementX/l.value,V=$.movementY/l.value;a.value.x+=n,a.value.y+=V},se=()=>{M.value=!1},Q=()=>{if(!a.value)return;const $=a.value.pageIndex,n=v.value[$].indexOf(a.value);n!==-1&&(v.value[$].splice(n,1),a.value=null)},te=()=>{a.value=null,v.value={}},N=()=>{if(h.value=!0,!!a.value){if(a.value.label=a.value.label,!a.value.label){f.value.label="Label is required";return}v.value={...v.value},R.value=!1}},_=$=>{const n=$.x*l.value,V=$.y*l.value,O=$.width*l.value,F=$.height*l.value;return{position:"absolute",left:`${n}px`,top:`${V}px`,width:`${O}px`,height:`${F}px`,border:$===a.value?"2px solid blue":"2px solid red",backgroundColor:"rgba(255, 0, 0, 0.2)",cursor:"move"}},ae=()=>{a.value.type=a.value.type&&a.value.type!=""?a.value.type:"multiple_choice",h.value=!1,R.value=!0},B=()=>{a.value=null,h.value=!1,R.value=!1},u=()=>{i.push({name:"examTemplates"})};return ue(()=>{k(),window.addEventListener("mouseup",()=>{q(),se()}),window.addEventListener("mousemove",W)}),($,n)=>{const V=x("Button"),O=x("Toolbar"),F=x("InputText"),H=x("Message"),oe=x("RadioButton"),ie=x("InputNumber"),Y=x("Dialog"),ce=he("tooltip");return w(),U("div",Nl,[t(O,{class:"sticky top-0 z-5 p-3 surface-0 border-bottom-1 surface-border pb-2"},{start:r(()=>[e("div",jl,[t(V,{type:"button",label:"Back",icon:"pi pi-arrow-left",onClick:u,class:"mr-2"}),t(V,{label:"Update Selected",icon:"pi pi-pencil",onClick:ae,disabled:!a.value,class:"mr-2",size:""},null,8,["disabled"]),t(V,{label:"Delete Selected",icon:"pi pi-trash",onClick:Q,class:"p-button-danger mr-2",size:""}),t(V,{label:"Delete All",icon:"pi pi-trash",onClick:te,class:"p-button-danger mr-2",disabled:v.value.length<1,size:""},null,8,["disabled"]),t(V,{label:"Save",icon:"pi pi-save",onClick:y,class:"p-button-success"})])]),end:r(()=>[G(t(V,{icon:"pi pi-search-plus",onClick:b,class:"mr-2",rounded:""},null,512),[[ce,"Zoom In",void 0,{bottom:!0}]]),G(t(V,{icon:"pi pi-search-minus",onClick:E,class:"mr-2",rounded:""},null,512),[[ce,"Zoom Out",void 0,{bottom:!0}]]),G(t(V,{icon:"pi pi-refresh",onClick:C,class:"mr-2",rounded:""},null,512),[[ce,"Zoom Reset",void 0,{bottom:!0}]])]),_:1}),e("div",ql,[n[10]||(n[10]=e("h4",{class:""},"Create Answer Region",-1)),n[11]||(n[11]=e("p",{class:"text-xs mb-5"},[I(" 1. Click and drag your mouse to draw a rectangle around the area to assign an answer region. "),e("br"),I(" 2. After drawing, click inside the rectangle to select update the info or adjust its position by dragging."),e("br"),I(' 3. Click "Save" button, after all region are assign. ')],-1)),(w(!0),U(pe,null,we(p.value,(z,_e)=>(w(),U("div",{key:_e,class:"relative mb-6 bg-white p-0 rounded-md shadow"},[e("canvas",{ref_for:!0,ref:re=>D[_e]=re,onMousedown:re=>J(re,_e),onMousemove:ee,style:{border:"1px solid #ccc"}},null,40,Yl),(w(!0),U(pe,null,we(v.value[_e]||[],(re,Ve)=>(w(),U("div",{key:Ve,style:ke(_(re)),class:"absolute",onMousedown:Ue=>le(Ue,re),onMouseup:se},[e("small",Kl,A(re.label),1)],44,Xl))),128))]))),128))]),t(Y,{visible:R.value,"onUpdate:visible":n[9]||(n[9]=z=>R.value=z),style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},header:"Update Info",modal:!0,class:""},{footer:r(()=>[t(V,{label:"Cancel",icon:"pi pi-times",onClick:B,severity:"secondary"}),t(V,{label:"Save",icon:"pi pi-check",onClick:N})]),default:r(()=>[e("div",Wl,[n[12]||(n[12]=e("label",{for:"label",class:"font-medium",style:{width:"75px"}},"Page No",-1)),e("div",Hl,A(a.value.pageIndex+1),1)]),e("div",Zl,[n[13]||(n[13]=e("label",{for:"label",class:"font-medium",style:{width:"75px"}},"Coordinate",-1)),e("div",Gl," ["+A(a.value.x)+", "+A(a.value.y)+", "+A(a.value.width)+", "+A(a.value.height)+"] ",1)]),e("div",Jl,[n[14]||(n[14]=e("label",{for:"label",class:"font-medium mt-2",style:{width:"75px"}},"Label",-1)),e("div",Ql,[t(F,{modelValue:a.value.label,"onUpdate:modelValue":n[0]||(n[0]=z=>a.value.label=z),modelModifiers:{trim:!0},invalid:h.value&&"label"in f.value,placeholder:"label",id:"label",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.label?(w(),j(H,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.label),1)]),_:1})):L("",!0)])]),e("div",es,[n[19]||(n[19]=e("label",{for:"role",class:"font-medium",style:{width:"75px"}},"Type",-1)),e("div",ts,[e("div",ls,[e("div",ss,[t(oe,{modelValue:a.value.type,"onUpdate:modelValue":n[1]||(n[1]=z=>a.value.type=z),inputId:"multiple_choice",name:"regionType",value:"multiple_choice"},null,8,["modelValue"]),n[15]||(n[15]=e("label",{for:"multiple_choice"},"multiple choice",-1))]),e("div",as,[t(oe,{modelValue:a.value.type,"onUpdate:modelValue":n[2]||(n[2]=z=>a.value.type=z),inputId:"short_answer",name:"regionType",value:"short_answer"},null,8,["modelValue"]),n[16]||(n[16]=e("label",{for:"short_answer"},"short answer",-1))]),e("div",os,[t(oe,{modelValue:a.value.type,"onUpdate:modelValue":n[3]||(n[3]=z=>a.value.type=z),inputId:"long_answer",name:"regionType",value:"long_answer"},null,8,["modelValue"]),n[17]||(n[17]=e("label",{for:"long_answer"},"long answer",-1))]),e("div",ns,[t(oe,{modelValue:a.value.type,"onUpdate:modelValue":n[4]||(n[4]=z=>a.value.type=z),inputId:"qr_code",name:"regionType",value:"qr code"},null,8,["modelValue"]),n[18]||(n[18]=e("label",{for:"qr_code"},"qr code",-1))])]),h.value&&f.value.type?(w(),j(H,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.type),1)]),_:1})):L("",!0)])]),e("div",is,[n[20]||(n[20]=e("label",{for:"options",class:"font-medium mt-2",style:{width:"75px"}},"Options",-1)),e("div",rs,[t(F,{modelValue:a.value.options,"onUpdate:modelValue":n[5]||(n[5]=z=>a.value.options=z),modelModifiers:{trim:!0},invalid:h.value&&"options"in f.value,placeholder:"options",id:"options",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.options?(w(),j(H,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.options),1)]),_:1})):L("",!0)])]),e("div",us,[n[21]||(n[21]=e("label",{for:"correctAnswer",class:"font-medium mt-2",style:{width:"75px"}},"Correct Answer",-1)),e("div",ds,[t(F,{modelValue:a.value.correctAnswer,"onUpdate:modelValue":n[6]||(n[6]=z=>a.value.correctAnswer=z),modelModifiers:{trim:!0},invalid:h.value&&"correctAnswer"in f.value,placeholder:"correctAnswer",id:"correctAnswer",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.correctAnswer?(w(),j(H,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.correctAnswer),1)]),_:1})):L("",!0)])]),e("div",cs,[n[22]||(n[22]=e("label",{for:"rubricAnswer",class:"font-medium mt-2",style:{width:"75px"}},"Rubric Answer",-1)),e("div",ms,[t(F,{modelValue:a.value.rubricAnswer,"onUpdate:modelValue":n[7]||(n[7]=z=>a.value.rubricAnswer=z),modelModifiers:{trim:!0},invalid:h.value&&"rubricAnswer"in f.value,placeholder:"correctAnswer",id:"rubricAnswer",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.rubricAnswer?(w(),j(H,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.rubricAnswer),1)]),_:1})):L("",!0)])]),e("div",ps,[n[23]||(n[23]=e("label",{for:"points",class:"font-medium mt-2",style:{width:"75px"}},"Points",-1)),e("div",vs,[t(ie,{modelValue:a.value.points,"onUpdate:modelValue":n[8]||(n[8]=z=>a.value.points=z),modelModifiers:{trim:!0},invalid:h.value&&"points"in f.value,placeholder:"points",id:"points",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),h.value&&f.value.points?(w(),j(H,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(f.value.points),1)]),_:1})):L("",!0)])]),e("div",fs,[h.value&&f.value.general?(w(),U("small",gs,A(f.value.general),1)):L("",!0)])]),_:1},8,["visible"])])}}},me={addExamTemplate(c){return K.post("exam-templates",c)},getExamTemplates(){return K.get("exam-templates")},getOneExamTemplate(c){return K.get("exam-templates/"+c)},updateExamRegion(c,g){return K.put("exam-templates/"+c+"/regions",g)},updateExamInfo(c,g){return K.put("exam-templates/"+c+"/info",g)},uploadStudentAnswers(c,g){return K.post("exam-templates/"+c+"/student-answers",g)},softDeleteExamTemplates(c){return K.put("exam-templates/delete-many",c)}},bs={name:"LoadingLayout",setup(){}},ws={class:"loading-content"},ys={class:"flex justify-center"};function xs(c,g,o,d,y,i){const l=x("ProgressSpinner");return w(),U("div",ws,[e("div",ys,[t(l)])])}const Re=fe(bs,[["render",xs]]),hs={key:0},ks={key:1,class:"grid"},$s={class:"col-12"},As={class:"card main-card"},Ss={__name:"CreateRegion",setup(c){const g=ye(),o=Ae(),d=de(),y=m(!1),i=m({}),l=m(null),p=m({});ue(()=>{y.value=!0,o.params.id||d.push({name:"examTemplates"}),me.getOneExamTemplate(o.params.id).then(P=>{if(P.status===200){i.value=P.data.data;const M=D(i.value.documentUrl);M&&M!==""&&(l.value=v(M)),y.value=!1}}).catch(P=>{P&&(P.response.status===400||P.response.status===500)?p.value.general=P.response.data.message:(p.value.general="An error occurred. Please try again later.",y.value=!1)})});function D(P){try{const T=new URL(P).pathname,S=T.lastIndexOf(".");if(S>0)return T.substring(S+1)}catch(M){console.error("Invalid URL:",M.message)}return""}function v(P){const M=P.toLowerCase(),T=["jpg","jpeg","png","gif","bmp","webp","svg","ico","tif","tiff"],S=["pdf"];return T.includes(M)?"image":S.includes(M)?"pdf":"other"}const a=P=>{me.updateExamRegion(o.params.id,{regions:P.value}).then(M=>{if(M.status===200){const T=M.data;g.add({severity:"success",summary:"Region Update Success",detail:T.data.message,life:3e3})}}).catch(M=>{console.log(M),M&&(M.response.status===400||M.response.status===500)?p.value.general=M.response.data.message:p.value.general="An error occurred. Please try again later."})};return(P,M)=>y.value?(w(),U("div",hs,[t(Re)])):(w(),U("div",ks,[e("div",$s,[e("div",As,[l.value==="image"?(w(),j(_s,{key:0,documentPath:i.value.documentUrl,regionsFromServer:i.value.regions??[],onSaveRegion:a},null,8,["documentPath","regionsFromServer"])):L("",!0),l.value==="pdf"?(w(),j(zl,{key:1,documentPath:i.value.documentUrl,regionsFromServer:i.value.regions??[],onSaveRegion:a},null,8,["documentPath","regionsFromServer"])):L("",!0)])])]))}},Cs={class:"grid"},Ts={class:"col-12"},Rs={class:"card main-card"},Ps={class:"my-2"},Is={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},Vs={class:"flex items-center gap-4 mb-4"},Us={class:"flex flex-column flex-auto gap-1"},Ms={class:"field"},Ds={key:0,class:"p-error"},Es={class:"flex align-items-center justify-content-center my-3"},Ls={key:0},Bs={__name:"ListExamTemplate",setup(c){const g=ye(),o=m({}),d=m(null),y=m(!1),i=m(!1),l=m({}),p=m(null),D=m(null),v=m(!1),a=m({global:{value:null,matchMode:Te.CONTAINS}});ue(()=>{me.getExamTemplates().then(b=>{b.status===200&&(d.value=b.data)}).catch(b=>{b&&(b.response.status===400||b.response.status===500)?o.value.general=b.response.data.message:o.value.general="An error occurred. Please try again later."})});const P=()=>{ne.push({name:"createExamTemplate"})},M=b=>{l.value={...b},v.value=!1,y.value=!0},T=()=>{y.value=!1,v.value=!1},S=b=>{let C=-1;for(let E=0;E<d.value.length;E++)if(d.value[E]._id===b){C=E;break}return C},R=()=>{if(v.value=!0,l.value._id){if(l.value.title.trim()===""){o.value.title="title is required";return}const b={title:l.value.title};me.updateExamInfo(l.value._id,b).then(C=>{if(C.status===200){const E=C.data;l.value.createdAt=E.data.createdAt,l.value.updatedAt=E.data.updatedAt,d.value[S(l.value._id)]=l.value,g.add({severity:"success",summary:"Successful",detail:E.data.message,life:3e3}),y.value=!1,l.value={}}}).catch(C=>{C&&(C.response.status===400||C.response.status===500)?o.value.general=C.response.data.message:o.value.general="An error occurred. Please try again later."})}},h=()=>{D.value.exportCSV()},f=()=>{i.value=!0},Z=()=>{if(o.value={},p.value.length>0){const b={ids:p.value.map(C=>C._id)};me.softDeleteExamTemplates(b).then(C=>{C.status===200&&(d.value=d.value.filter(E=>!p.value.includes(E)),i.value=!1,p.value=null,g.add({severity:"success",summary:"Successful",detail:C.data.message,life:3e3}))}).catch(C=>{C&&(C.response.status===400||C.response.status===404||C.response.status===500)?o.value.general=C.response.data.message:o.value.general="An error occurred. Please try again later.",i.value=!1,p.value=null,g.add({severity:"error",summary:"Error",detail:o.value.general,life:3e3})})}else i.value=!1,p.value=null},X=b=>{l.value={...b},ne.push({name:"createRegion",params:{id:l.value._id}})},k=b=>{l.value={...b},ne.push({name:"uploadStudentAnswers",params:{id:l.value._id}})},s=b=>{l.value={...b},ne.push({name:"studentAnswers",params:{id:l.value._id}})};return(b,C)=>{const E=x("Button"),J=x("Toolbar"),ee=x("InputIcon"),q=x("InputText"),le=x("IconField"),W=x("Column"),se=x("DataTable"),Q=x("Message"),te=x("Dialog"),N=he("tooltip");return w(),U("div",Cs,[e("div",Ts,[e("div",Rs,[t(J,{class:"mb-4"},{start:r(()=>[e("div",Ps,[t(E,{label:"New",icon:"pi pi-plus",class:"mr-2",severity:"success",onClick:P}),t(E,{label:"Delete",icon:"pi pi-trash",severity:"danger",onClick:f,disabled:!p.value||!p.value.length},null,8,["disabled"])])]),end:r(()=>[t(E,{label:"Export",icon:"pi pi-upload",severity:"help",onClick:C[0]||(C[0]=_=>h(_))})]),_:1}),t(se,{ref_key:"dt",ref:D,stripedRows:"",value:d.value,selection:p.value,"onUpdate:selection":C[2]||(C[2]=_=>p.value=_),dataKey:"_id",paginator:!0,rows:100,filters:a.value,"onUpdate:filters":C[3]||(C[3]=_=>a.value=_),filterDisplay:"row",globalFilterFields:["name","email","role","status"],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[100,200,300],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} exam templates"},{header:r(()=>[e("div",Is,[C[8]||(C[8]=e("h5",{class:"m-0"},"Manage Exam Template",-1)),t(le,{iconPosition:"left",class:"block mt-2 md:mt-0"},{default:r(()=>[t(ee,{class:"pi pi-search"}),t(q,{class:"w-full sm:w-auto",modelValue:a.value.global.value,"onUpdate:modelValue":C[1]||(C[1]=_=>a.value.global.value=_),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:r(()=>[t(W,{selectionMode:"multiple",headerStyle:"width: 3rem"}),t(W,{field:"title",header:"Template ID",sortable:!0,headerStyle:""},{body:r(_=>[I(A(_.data.title),1)]),_:1}),t(W,{field:"status",header:"Status",sortable:!0,headerStyle:""},{body:r(_=>[I(A(_.data.status),1)]),_:1}),t(W,{field:"craetedBy",header:"Created By",sortable:!0,headerStyle:""},{body:r(_=>[I(A(_.data.createdBy.name),1)]),_:1}),G(t(W,{headerStyle:""},{body:r(_=>[G(t(E,{icon:"pi pi-pencil",class:"mr-2",severity:"success",rounded:"",onClick:ae=>M(_.data)},null,8,["onClick"]),[[N,"Edit Exam Template",void 0,{bottom:!0}]]),G(t(E,{icon:"pi pi-map-marker",class:"mr-2",severity:"info",rounded:"",onClick:ae=>X(_.data)},null,8,["onClick"]),[[N,"Set Answer Region",void 0,{bottom:!0}]]),G(t(E,{icon:"pi pi-upload",class:"mr-2",severity:"help",rounded:"",onClick:ae=>k(_.data)},null,8,["onClick"]),[[N,"Upload Student Answer",void 0,{bottom:!0}]]),G(t(E,{icon:"pi pi-cog",class:"mr-2",rounded:"",onClick:ae=>s(_.data)},null,8,["onClick"]),[[N,"Manage/OCR Answers",void 0,{bottom:!0}]])]),_:1},512),[[Ce,!1]]),t(W,{field:"createdAt",hidden:!0}),t(W,{field:"updatedAt",hidden:!0})]),_:1},8,["value","selection","filters"]),t(te,{visible:y.value,"onUpdate:visible":C[5]||(C[5]=_=>y.value=_),style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},header:l.value._id?"Update Exam Template":"Add New Exam Template",modal:!0,class:""},{footer:r(()=>[t(E,{label:"Cancel",icon:"pi pi-times",onClick:T,severity:"secondary"}),t(E,{label:l.value._id?"Update":"Save",icon:"pi pi-check",onClick:R},null,8,["label"])]),default:r(()=>[e("div",Vs,[C[9]||(C[9]=e("label",{for:"title",class:"font-medium mt-2",style:{width:"90px"}},"Template Id",-1)),e("div",Us,[t(q,{modelValue:l.value.title,"onUpdate:modelValue":C[4]||(C[4]=_=>l.value.title=_),modelModifiers:{trim:!0},invalid:v.value&&"title"in o.value,placeholder:"Name",id:"title",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),v.value&&o.value.title?(w(),j(Q,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(o.value.title),1)]),_:1})):L("",!0)])]),e("div",Ms,[v.value&&o.value.general?(w(),U("small",Ds,A(o.value.general),1)):L("",!0)])]),_:1},8,["visible","header"]),t(te,{visible:i.value,"onUpdate:visible":C[7]||(C[7]=_=>i.value=_),style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},header:"Confirmation",modal:!0},{footer:r(()=>[t(E,{label:"No",icon:"pi pi-times",onClick:C[6]||(C[6]=_=>i.value=!1),severity:"secondary"}),t(E,{label:"Yes",icon:"pi pi-check",onClick:Z,severity:"danger"})]),default:r(()=>[e("div",Es,[C[10]||(C[10]=e("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),l.value?(w(),U("span",Ls,"Are you sure you want to delete the selected exam templates?")):L("",!0)])]),_:1},8,["visible"])])])])}}},Fs=fe(Bs,[["__scopeId","data-v-3344a02a"]]),Os={class:"grid"},zs={class:"col-12"},Ns={class:"card main-card"},js={class:"my-2"},qs={class:"flex items-center gap-4 mb-4"},Ys={class:"flex flex-column flex-auto gap-1"},Xs={class:"flex items-center gap-4 mb-4"},Ks={class:"flex flex-column flex-auto gap-1"},Ws={class:""},Hs={class:"exam-template-fileupload"},Zs={class:"flex gap-2",style:{width:"100%"}},Gs={key:0},Js={key:1,class:"my-3"},Qs={style:{height:"300px"}},ea=["src"],ta=["src","onClick"],la={key:2,class:"my-3"},sa=["src"],aa={key:3,class:"p-error"},oa={class:"field"},na={key:0,class:"p-error"},ia={__name:"CreateExamTemplate",setup(c){const g=ye();m("");const o=m(""),d=m({}),y=m({}),i=m({}),l=m(!1),p=m("/images/noimage.png"),D=(T,S)=>{S(),T()},v=T=>{T(),d.value=null,y.value=null},a=()=>{ne.push({name:"examTemplates"})},P=T=>{d.value=T.files[T.files.length-1];const S=T.files[T.files.length-1];if(S&&S.type.startsWith("image/")){const R=new FileReader;R.onload=h=>{y.value={thumbnail:h.target.result,normal:h.target.result}},R.readAsDataURL(S)}else y.value=null,p.value="/images/pdf.png"},M=()=>{if(i.value={},l.value=!0,o.value||(i.value.title="Exam Template Title is required"),d.value||(i.value.examDocument="Document is required"),!i.value.title&&!i.value.examDocument){let T=new FormData;T.append("title",o.value),T.append("file",d.value),me.addExamTemplate(T).then(S=>{if(S.status===201){const R=S.data;g.add({severity:"success",summary:"Successful",detail:R.data.message,life:3e3}),o.value="",d.value=null,y.value=null,ne.push({name:"createRegion",params:{id:R.data._id}})}}).catch(S=>{console.log(S),S&&(S.response.status===400||S.response.status===500)?i.value.general=S.response.data.message:i.value.general="An error occurred. Please try again later."})}};return(T,S)=>{const R=x("Button"),h=x("Toolbar"),f=x("InputText"),Z=x("Message"),X=x("FileUpload"),k=x("Image");return w(),U("div",Os,[e("div",zs,[e("div",Ns,[t(h,{class:"mb-4"},{start:r(()=>[e("div",js,[t(R,{type:"button",label:"Back",icon:"pi pi-arrow-left",onClick:a})])]),end:r(()=>S[1]||(S[1]=[])),_:1}),S[6]||(S[6]=e("h4",{class:"mb-5"},"Create Exam Template",-1)),e("div",qs,[S[2]||(S[2]=e("label",{for:"title",class:"font-medium mt-2",style:{width:"150px"}},"Exam Template Title",-1)),e("div",Ys,[t(f,{modelValue:o.value,"onUpdate:modelValue":S[0]||(S[0]=s=>o.value=s),modelModifiers:{trim:!0},invalid:l.value&&"title"in i.value,placeholder:"Title",id:"title",class:"w-full",autocomplete:"off"},null,8,["modelValue","invalid"]),l.value&&i.value.title?(w(),j(Z,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[I(A(i.value.title),1)]),_:1})):L("",!0)])]),e("div",Xs,[S[5]||(S[5]=e("label",{for:"document",class:"font-medium mt-2",style:{width:"150px"}},"Document",-1)),e("div",Ks,[e("div",Ws,[e("div",Hs,[t(X,{name:"examDocument",accept:"image/*,application/pdf",maxFileSize:1e6,chooseLabel:"Browse",multiple:!1,auto:!1,onSelect:P,customUpload:""},{header:r(({chooseCallback:s,clearCallback:b})=>[e("div",Zs,[t(R,{onClick:C=>D(s,b),label:"Choose",icon:"pi pi-images",outlined:""},null,8,["onClick"]),t(R,{label:"Cancel",icon:"pi pi-times",onClick:C=>v(b),outlined:"",severity:"danger",disabled:!d.value},null,8,["onClick","disabled"])])]),content:r(()=>S[3]||(S[3]=[I("")])),_:1})]),d.value?(w(),U("p",Gs,A(d.value.name),1)):L("",!0),y.value&&y.value.thumbnail!=null?(w(),U("div",Js,[t(k,{alt:"Image",preview:""},{indicatoricon:r(()=>S[4]||(S[4]=[e("i",{class:"pi pi-search"},null,-1)])),image:r(()=>[e("div",Qs,[e("img",{src:y.value.thumbnail,alt:"image",style:{width:"100%",border:"1px solid #ccc",padding:"3px",height:"300px"}},null,8,ea)])]),preview:r(s=>[e("img",{src:y.value.normal,alt:"preview",style:ke(s.style),onClick:s.onClick},null,12,ta)]),_:1})])):(w(),U("div",la,[e("img",{src:p.value,alt:"image",style:{border:"1px solid #ccc",padding:"3px",height:"300px"}},null,8,sa)])),l.value&&i.value.examDocument?(w(),U("small",aa,A(i.value.examDocument),1)):L("",!0)])])]),e("div",oa,[l.value&&i.value.general?(w(),U("small",na,A(i.value.general),1)):L("",!0)]),t(R,{label:"Submit",class:"p-3 text-xl mt-5",onClick:M})])])])}}},ra=fe(ia,[["__scopeId","data-v-00854911"]]),ua={key:0},da={key:1,class:"grid"},ca={class:"col-12"},ma={class:"card main-card"},pa={class:"my-2"},va={class:"flex items-center gap-4 py-2"},fa={class:"flex items-center gap-4 py-2"},ga={class:"flex items-center gap-4 py-2 mb-4"},_a={class:"flex items-center gap-4 mb-4"},ba={class:"flex flex-column flex-auto gap-1"},wa={class:""},ya={class:"answer-fileupload"},xa={class:"flex gap-2",style:{width:"100%"}},ha={key:0,style:{display:"none"}},ka={key:0,class:"p-error"},$a={class:"field"},Aa={key:0,class:"p-error"},Sa={__name:"UploadStudentAnswers",setup(c){const g=Ae(),o=de(),d=m(!1),y=ye(),i=m({}),l=m([]),p=m({}),D=m(!1),v=m(null),a=m(null),P=R=>{a.value=R},M=()=>{o.push({name:"examTemplates"})},T=R=>{l.value=R.files},S=()=>{if(p.value={},D.value=!0,l.value.length===0){p.value.answerDocuments="Student Answer Document is required";return}let R=new FormData;l.value.forEach(h=>{R.append("files",h)}),me.uploadStudentAnswers(g.params.id,R).then(h=>{if(h.status===201){a.value?.();const f=h.data;y.add({severity:"success",summary:"Successful",detail:f.data.message,life:3e3}),l.value=[]}}).catch(h=>{console.log(h),h&&(h.response.status===400||h.response.status===500)?p.value.general=h.response.data.message:p.value.general="An error occurred. Please try again later."})};return ue(()=>{d.value=!0,g.params.id||o.push({name:"examTemplates"}),me.getOneExamTemplate(g.params.id).then(R=>{R.status===200&&(i.value=R.data.data,d.value=!1)}).catch(R=>{R&&(R.response.status===400||R.response.status===500)?p.value.general=R.response.data.message:(p.value.general="An error occurred. Please try again later.",d.value=!1)})}),(R,h)=>{const f=x("Button"),Z=x("Toolbar"),X=x("FileUpload");return d.value?(w(),U("div",ua,[t(Re)])):(w(),U("div",da,[e("div",ca,[e("div",ma,[t(Z,{class:"mb-4"},{start:r(()=>[e("div",pa,[t(f,{type:"button",label:"Back",icon:"pi pi-arrow-left",onClick:M})])]),end:r(()=>h[0]||(h[0]=[])),_:1}),h[5]||(h[5]=e("h4",{class:"mb-5"},"Upload Studnet Answers",-1)),e("div",va,[h[1]||(h[1]=e("label",{for:"title",class:"font-medium",style:{width:"90px"}},"Exam Info",-1)),e("div",null,A(i.value.title),1)]),e("div",fa,[h[2]||(h[2]=e("label",{for:"title",class:"font-medium",style:{width:"90px"}},"No of Pages",-1)),e("div",null,A(i.value.pages),1)]),e("div",ga,[h[3]||(h[3]=e("label",{for:"title",class:"font-medium",style:{width:"90px"}},"Status",-1)),e("div",null,A(i.value.status),1)]),e("div",_a,[h[4]||(h[4]=e("label",{for:"document",class:"font-medium mt-2",style:{width:"90px"}},"Student Answers",-1)),e("div",ba,[e("div",wa,[e("div",ya,[t(X,{name:"answerDocuments",accept:"image/jpg, image/jpeg, image/png",maxFileSize:1e6,chooseLabel:"Browse",multiple:!0,auto:!1,onSelect:T,customUpload:"",ref_key:"fileUploadRef",ref:v},{header:r(({chooseCallback:k,clearCallback:s})=>[e("div",xa,[t(f,{onClick:k,label:"Choose",icon:"pi pi-images",outlined:""},null,8,["onClick"]),P(s)?(w(),U("span",ha)):L("",!0)])]),_:1},512)]),D.value&&p.value.answerDocuments?(w(),U("small",ka,A(p.value.answerDocuments),1)):L("",!0)])])]),e("div",$a,[D.value&&p.value.general?(w(),U("small",Aa,A(p.value.general),1)):L("",!0)]),t(f,{label:"Submit",class:"p-3 mt-5",onClick:S})])])]))}}},Se={findAllStudentAnswers(c){return K.get("exam-templates/"+c+"/student-answers")},uploadStudentAnswers(c,g){return K.post("exam-templates/"+c+"/student-answers",g)},ocrRequest(c,g){return K.post("exam-templates/"+c+"/student-answers/ocr",g)},getStudentAnswerOcrResult(c,g){return K.get("exam-templates/"+c+"/student-answers/"+g)}},Ca={class:"grid"},Ta={class:"col-12"},Ra={class:"card main-card"},Pa={class:"my-2"},Ia={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},Va={class:"flex flex-wrap gap-2"},Ua=["src"],Ma=["src","onClick"],Da={key:0},Ea={__name:"StudentAnswers",setup(c){const g=ye(),o=Ae(),d=de(),y=m({}),i=m(null),l=m(!1),p=m(null),D=m(null),v=m(!1),a=m(0),P=m(0),M=Ee(()=>a.value===0?0:(a.value-P.value)/a.value*100),T=m({global:{value:null,matchMode:Te.CONTAINS}});ue(()=>{Se.findAllStudentAnswers(o.params.id).then(k=>{k.status===200&&(i.value=k.data)}).catch(k=>{k&&(k.response.status===400||k.response.status===500)?y.value.general=k.response.data.message:y.value.general="An error occurred. Please try again later."})});const S=k=>{let s=-1;for(let b=0;b<i.value.length;b++)if(i.value[b]._id===k){s=b;break}return s},R=()=>{l.value=!0},h=async()=>{const k=p.value.map(b=>b._id);if(!k.length){l.value=!1,p.value=null,v.value=!1;return}v.value=!0,P.value=k.length,y.value={};const s=o.params.id;await f(s,k,!0)},f=async(k,s,b)=>{try{const C={ids:s,resetFlag:b},E=await Se.ocrRequest(k,C);if(E.status===200){const J=E.data.studentAnswer,ee=S(J._id);ee!==-1&&i.value.splice(ee,1,J),console.log(E.data),E.data.ocrPending&&E.data.ocrPending!==0?(P.value=E.data.ocrPending,a.value=E.data.ocrProcessTotal,await f(k,s,!1)):Z(E)}else throw new Error("Unexpected response status: "+E.status)}catch(C){y.value.general=C.response?.data?.message||"An error occurred. Please try again later.",l.value=!1,p.value=null,v.value=!1,g.add({severity:"error",summary:"Error",detail:y.value.general,life:3e3}),Z({})}},Z=k=>{a.value=0,P.value=0,l.value=!1,p.value=null,v.value=!1,g.add({severity:"success",summary:"Successful",detail:k.data.message||"OCR processing complete",life:3e3})},X=k=>{d.push({name:"viewOcrResult",params:{id:o.params.id,answerId:k._id}})};return(k,s)=>{const b=x("Button"),C=x("Toolbar"),E=x("InputIcon"),J=x("InputText"),ee=x("IconField"),q=x("Column"),le=x("Image"),W=x("DataTable"),se=x("ProgressBar"),Q=x("Dialog"),te=he("tooltip");return w(),U("div",Ca,[e("div",Ta,[e("div",Ra,[t(C,{class:"mb-4"},{start:r(()=>[e("div",Pa,[t(b,{type:"button",label:"Back",icon:"pi pi-arrow-left",class:"mr-2",onClick:s[0]||(s[0]=N=>be(d).push({name:"examTemplates"}))}),t(b,{label:"Mark OCR Test",icon:"pi pi-check",severity:"success",onClick:R,disabled:!p.value||!p.value.length},null,8,["disabled"])])]),_:1}),t(W,{ref_key:"dt",ref:D,stripedRows:"",value:i.value,selection:p.value,"onUpdate:selection":s[2]||(s[2]=N=>p.value=N),dataKey:"_id",paginator:!0,rows:100,filters:T.value,"onUpdate:filters":s[3]||(s[3]=N=>T.value=N),filterDisplay:"row",globalFilterFields:["name","email","role","status"],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[100,200,300],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} studentAnswers"},{header:r(()=>[e("div",Ia,[s[6]||(s[6]=e("h5",{class:"m-0"},"Manage Student Answers",-1)),t(ee,{iconPosition:"left",class:"block mt-2 md:mt-0"},{default:r(()=>[t(E,{class:"pi pi-search"}),t(J,{class:"w-full sm:w-auto",modelValue:T.value.global.value,"onUpdate:modelValue":s[1]||(s[1]=N=>T.value.global.value=N),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:r(()=>[t(q,{selectionMode:"multiple",headerStyle:"width: 3rem"}),t(q,{field:"processedImagesUrl",header:"Answer Image",sortable:!0,headerStyle:""},{body:r(N=>[e("div",Va,[(w(!0),U(pe,null,we(N.data.processedImagesUrl,(_,ae)=>(w(),j(le,{key:ae,alt:"Image",preview:""},{previewicon:r(()=>s[7]||(s[7]=[e("i",{class:"pi pi-search"},null,-1)])),image:r(()=>[e("img",{src:`${be(xe)}/${_}`,alt:"image",style:{width:"80px",height:"auto","border-radius":"4px"}},null,8,Ua)]),preview:r(B=>[e("img",{src:`${be(xe)}/${_}`,alt:"preview",style:ke(B.style),onClick:B.onClick},null,12,Ma)]),_:2},1024))),128))])]),_:1}),t(q,{field:"status",header:"OCR Status",sortable:!0,headerStyle:""},{body:r(N=>[I(A(N.data.status),1)]),_:1}),G(t(q,{headerStyle:"width: 3rem"},{body:r(N=>[G(t(b,{icon:"pi pi-eye",class:"mr-2",severity:"info",rounded:"",onClick:_=>X(N.data),disabled:N.data.status=="pending"},null,8,["onClick","disabled"]),[[te,"View OCR Result",void 0,{bottom:!0}]])]),_:1},512),[[Ce,!1]]),t(q,{field:"createdAt",hidden:!0}),t(q,{field:"updatedAt",hidden:!0})]),_:1},8,["value","selection","filters"]),t(Q,{visible:l.value,"onUpdate:visible":s[5]||(s[5]=N=>l.value=N),style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},header:"Confirmation",modal:!0},{footer:r(()=>[t(b,{label:"No",icon:"pi pi-times",onClick:s[4]||(s[4]=N=>l.value=!1),severity:"secondary"}),t(b,{label:"Yes",icon:"pi pi-check",onClick:h,severity:"success"})]),default:r(()=>[s[8]||(s[8]=e("div",{class:"flex align-items-center justify-content-center my-3"},[e("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),e("span",null,"Are you sure you want to do OCR and check result for selected student answers?")],-1)),v.value||P.value!=0?(w(),U("div",Da,[t(se,{value:M.value,showValue:""},null,8,["value"]),e("p",null,A(M.value.toFixed(0))+"%",1)])):L("",!0)]),_:1,__:[8]},8,["visible"])])])])}}},La=fe(Ea,[["__scopeId","data-v-bc12914b"]]),Ba={key:0},Fa={key:1,class:"grid"},Oa={class:"col-12"},za={class:"card main-card"},Na={class:"my-2"},ja={class:"flex items-center gap-4 py-2 mb-5"},qa={class:"flex flex-wrap gap-2"},Ya=["src"],Xa=["src","onClick"],Ka={style:{"white-space":"pre-line"}},Wa=["href"],Ha={__name:"ViewOcrResult",setup(c){const g=Ae(),o=de(),d=m(!1),y=m({}),i=m({}),l=m({}),p=m(null);ue(()=>{d.value=!0,g.params.id||o.push({name:"examTemplates"}),Se.getStudentAnswerOcrResult(g.params.id,g.params.answerId).then(a=>{a.status===200&&(y.value=a.data.ocrResult,i.value=a.data.studentAnswer,d.value=!1)}).catch(a=>{a&&(a.response.status===400||a.response.status===500)?l.value.general=a.response.data.message:(l.value.general="An error occurred. Please try again later.",d.value=!1)})});const D=a=>{switch(a){case"multiple_choice":return"Multiple Choice";case"short_answer":return"Short Answer";case"long_answer":return"Long Answer";default:return a}},v=()=>{o.push({name:"studentAnswers",params:{id:g.params.id}})};return(a,P)=>{const M=x("Button"),T=x("Toolbar"),S=x("Image"),R=x("Column"),h=x("DataTable");return d.value?(w(),U("div",Ba,[t(Re)])):(w(),U("div",Fa,[e("div",Oa,[e("div",za,[t(T,{class:"mb-4"},{start:r(()=>[e("div",Na,[t(M,{type:"button",label:"Back",icon:"pi pi-arrow-left",onClick:v})])]),end:r(()=>P[0]||(P[0]=[])),_:1}),e("div",ja,[P[2]||(P[2]=e("label",{for:"title",class:""},"Answer Image",-1)),e("div",null,[e("div",qa,[(w(!0),U(pe,null,we(i.value.processedImagesUrl,(f,Z)=>(w(),U("div",{key:Z},[t(S,{alt:"Image",preview:"",style:{border:"1px solid #ccc"}},{previewicon:r(()=>P[1]||(P[1]=[e("i",{class:"pi pi-search"},null,-1)])),image:r(()=>[e("img",{src:`${be(xe)}/${f}`,alt:"image",width:"80"},null,8,Ya)]),preview:r(X=>[e("img",{src:`${be(xe)}/${f}`,alt:"preview",style:ke(X.style),onClick:X.onClick},null,12,Xa)]),_:2},1024)]))),128))])])]),t(h,{ref_key:"dt",ref:p,stripedRows:"",value:y.value.ocrRegions,dataKey:"_id",paginator:!0,rows:100,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[100,200,300],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} users"},{header:r(()=>P[3]||(P[3]=[e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},[e("h5",{class:"m-0"},"OCR Result Detail")],-1)])),default:r(()=>[t(R,{field:"region",header:"region",headerStyle:""},{body:r(f=>[I(" Page "+A(f.data.page)+" - "+A(f.data.regionLabel),1)]),_:1}),t(R,{field:"type",header:"type",headerStyle:""},{body:r(f=>[I(A(D(f.data.type)),1)]),_:1}),t(R,{field:"detectAnswer",header:"Detect Answer",headerStyle:""},{body:r(f=>[e("div",Ka,A(f.data.detectAnswer),1),e("a",{href:`${be(xe)}/uploads/ocr_regions/${i.value.examTemplate}/${i.value._id}/${f.data.regionId}.jpg`,target:"_blank"},[t(M,{label:"image",size:"small",severity:"info"})],8,Wa)]),_:1}),t(R,{field:"confidence",header:"Confidence",headerStyle:""},{body:r(f=>[I(A(f.data.confidence),1)]),_:1}),t(R,{field:"isCorrect",header:"isCorrect",headerStyle:""},{body:r(f=>[I(A(f.data.isCorrect),1)]),_:1}),t(R,{field:"pointsAwarded",header:"Points Awarded",headerStyle:""},{body:r(f=>[I(A(f.data.pointsAwarded),1)]),_:1})]),_:1},8,["value"])])])]))}}},Za=[{path:"/login",name:"login",component:Ct},{path:"/:pathMatch(.*)*",name:"notfound",component:Rt},{path:"/",component:Lt,meta:{requiresAuth:!0},children:[{path:"",name:"home",component:bt},{path:"users",name:"users",component:cl},{path:"/exam-templates",name:"examTemplates",component:Fs},{path:"/exam-templates/new",name:"createExamTemplate",component:ra},{path:"/exam-templates/:id/create-region",name:"createRegion",component:Ss},{path:"/exam-templates/:id/upload-answers",name:"uploadStudentAnswers",component:Sa},{path:"/exam-templates/:id/student-answers",name:"studentAnswers",component:La},{path:"/exam-templates/:id/student-answers/:answerId",name:"viewOcrResult",component:Ha}]}],ne=Fe({history:Oe(),routes:Za}),Ga={ProgressBar:ut,Button:rt,Column:it,DataTable:nt,Dialog:ot,IconField:at,Image:st,InputIcon:lt,InputText:tt,InputNumber:et,Password:Qe,ProgressSpinner:Je,RadioButton:Ge,SelectButton:Ze,Toast:He,Toolbar:We,Message:Ke,Card:Xe,FileUpload:Ye},ge=Le(gt),Ja=Ne();ge.use(Ja);ge.use(ne);const Qa=ve();ne.beforeEach((c,g,o)=>{c.meta.requiresAuth&&!Qa.isAuthenticated?o("/login"):o()});ge.use(qe,{theme:{preset:Be,options:{darkModeSelector:"none"}}});ge.use(dt);ge.directive("tooltip",ct);for(const[c,g]of Object.entries(Ga))ge.component(c,g);ge.mount("#app");
